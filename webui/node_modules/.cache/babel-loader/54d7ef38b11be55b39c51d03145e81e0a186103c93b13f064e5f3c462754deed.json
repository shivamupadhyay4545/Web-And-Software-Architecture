{"ast":null,"code":"import axios from 'axios';\nimport moment from 'moment';\nexport default {\n  data() {\n    return {\n      comments: [],\n      photoBytes: ''\n    };\n  },\n  props: {\n    username: String,\n    PhotoId: String\n  },\n  computed: {\n    isOwner() {\n      // Check if the current user is the owner of the photo\n      return this.username === this.PhotoId.split('_')[0];\n    }\n  },\n  methods: {\n    async deleteComment(Content) {\n      const jsonPayload = {\n        Content\n      };\n      try {\n        const jsonPayload = {\n          Content\n        };\n        const queryParamValue = this.PhotoId; // Replace with your actual query parameter value\n        const url = `http://localhost:8080/user/${this.username}/photos/comment?Photoid=${queryParamValue}`;\n        const response = await axios.delete(url, {\n          data: jsonPayload\n        });\n        if (response.status === 200) {\n          console.log('Comment deleted successfully!');\n          // Fetch comments data after deleting the comment\n          this.fetchComments();\n        } else {\n          console.error('Failed to delete comment:', response.statusText);\n        }\n      } catch (error) {\n        console.log(jsonPayload);\n        console.error('Error deleting comment11:', error.message);\n      }\n    },\n    async deletePhoto() {\n      try {\n        // Assuming this.username, this.PhotoId, and other necessary values are defined\n        const url = `http://localhost:8080/user/${this.username}/deleted_photos?Photoid=${this.PhotoId}`;\n        const response = await axios.delete(url);\n        if (response.status === 200) {\n          window.history.back();\n          console.log('Photo deleted successfully!');\n          // Add additional logic if needed\n        } else {\n          console.error('Failed to delete photo:', response.statusText);\n        }\n      } catch (error) {\n        console.error('Error deleting photo:', error.message);\n      }\n    },\n    async fetchComments() {\n      const parts = this.PhotoId.split('_');\n      try {\n        const parts = this.PhotoId.split('_');\n        // Make a GET request to fetch comments data\n        const response = await axios.get(`http://localhost:8080/user/${parts[0]}/photos/${this.PhotoId}`);\n\n        // Update data with the fetched comments and photoBytes\n        this.comments = response.data.comments;\n        this.photoBytes = response.data.photobytes;\n      } catch (error) {\n        console.log(\"bhenchod\", parts[0], this.PhotoId);\n        console.error('Error fetching comments:', this.PhotoId, this.username);\n      }\n    },\n    getImageUrl(photobytes) {\n      if (photobytes) {\n        return `data:image/jpeg;base64,${photobytes}`;\n      }\n      return ''; // Return placeholder or empty string if photobytes is null or undefined\n    },\n    formatTimestamp(timestamp) {\n      // Use moment to format the timestamp\n      return moment(timestamp).format('YYYY-MM-DD HH:mm:ss');\n    }\n  },\n  mounted() {\n    // Fetch comments data when the component is mounted\n    this.fetchComments();\n  }\n};","map":{"version":3,"names":["axios","moment","data","comments","photoBytes","props","username","String","PhotoId","computed","isOwner","split","methods","deleteComment","Content","jsonPayload","queryParamValue","url","response","delete","status","console","log","fetchComments","error","statusText","message","deletePhoto","window","history","back","parts","get","photobytes","getImageUrl","formatTimestamp","timestamp","format","mounted"],"sources":["/Users/shivamkumar/Desktop/wasaphoto/webui/src/components/CommentPhotoForm.vue"],"sourcesContent":["<template>\n    <div>\n      <img :src=\"getImageUrl(photoBytes)\" alt=\"User Photo\" />\n      <button v-if=\"isOwner\" @click=\"deletePhoto\">Delete Photo</button>\n      <div v-for=\"comment in comments\" :key=\"comment.DateTime\">\n        <p>{{ comment.CommentUser }}:</p>\n        <p>{{ comment.Comment }}</p>\n        <p>{{ formatTimestamp(comment.DateTime) }}</p>\n        <button v-if=\"this.username === comment.CommentUser\" @click=\"deleteComment(comment.Comment)\">\n        Delete Comment\n      </button>\n        <hr />\n      </div>\n    </div>\n  </template>\n  \n  <script>\n  import axios from 'axios';\n  import moment from 'moment';\n  \n  export default {\n    data() {\n      return {\n        comments: [],\n        photoBytes: '',\n      };\n    },\n    props: {\n      username: String,\n      PhotoId: String,\n    },\n    computed: {\n    isOwner() {\n      // Check if the current user is the owner of the photo\n      return this.username === this.PhotoId.split('_')[0];\n    },\n  },\n    methods: {\n        async deleteComment(Content) {\n            const jsonPayload = { Content };\n      try {\n        const jsonPayload = { Content };\n\n        const queryParamValue = this.PhotoId; // Replace with your actual query parameter value\n        const url = `http://localhost:8080/user/${this.username}/photos/comment?Photoid=${queryParamValue}`;\n\n        const response = await axios.delete(url, { data: jsonPayload });\n\n\n        if (response.status === 200) {\n          console.log('Comment deleted successfully!');\n          // Fetch comments data after deleting the comment\n          this.fetchComments();\n        } else {\n          console.error('Failed to delete comment:', response.statusText);\n        }\n      } catch (error) {\n        console.log(jsonPayload)\n        console.error('Error deleting comment11:', error.message);\n      }\n    },\n\n    async deletePhoto() {\n      try {\n        // Assuming this.username, this.PhotoId, and other necessary values are defined\n        const url = `http://localhost:8080/user/${this.username}/deleted_photos?Photoid=${this.PhotoId}`;\n        \n        const response = await axios.delete(url);\n\n        if (response.status === 200) {\n            window.history.back();\n          console.log('Photo deleted successfully!');\n          // Add additional logic if needed\n        } else {\n          console.error('Failed to delete photo:', response.statusText);\n        }\n      } catch (error) {\n        console.error('Error deleting photo:', error.message);\n      }\n    },\n  \n\n\n      async fetchComments() {\n        const parts = this.PhotoId.split('_');\n        try {\n            const parts = this.PhotoId.split('_');\n          // Make a GET request to fetch comments data\n          const response = await axios.get(`http://localhost:8080/user/${parts[0]}/photos/${this.PhotoId}`);\n  \n          // Update data with the fetched comments and photoBytes\n          this.comments = response.data.comments;\n          this.photoBytes = response.data.photobytes;\n        } catch (error) {\n            console.log(\"bhenchod\",parts[0],this.PhotoId)\n          console.error('Error fetching comments:', this.PhotoId,this.username);\n        }\n      },\n      getImageUrl(photobytes) {\n        if (photobytes) {\n          return `data:image/jpeg;base64,${photobytes}`;\n        }\n        return ''; // Return placeholder or empty string if photobytes is null or undefined\n      },\n      formatTimestamp(timestamp) {\n        // Use moment to format the timestamp\n        return moment(timestamp).format('YYYY-MM-DD HH:mm:ss');\n      },\n    },\n    mounted() {\n      // Fetch comments data when the component is mounted\n      this.fetchComments();\n    },\n  };\n  </script>\n  \n  <style scoped>\n  /* Add your component styles here */\n  </style>\n  "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}